<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="HodgePotentialHumanFlow">
<title>Potential of Human flow (general graph case) • HodgePotentialHumanFlow</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Potential of Human flow (general graph case)">
<meta property="og:description" content="HodgePotentialHumanFlow">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">HodgePotentialHumanFlow</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/PotentialInLondon.html">Potential of Human flow (complete graph case)</a>
    <a class="dropdown-item" href="../articles/PotentialInTokyo.html">Potential of Human flow (general graph case)</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Potential of Human flow (general graph case)</h1>
            
      
      
      <div class="d-none name"><code>PotentialInTokyo.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="tutorial-potential-of-human-flow-general-graph-case">Tutorial: Potential of Human flow (general graph case)<a class="anchor" aria-label="anchor" href="#tutorial-potential-of-human-flow-general-graph-case"></a>
</h2>
<p>This tutorial demonstrates how to detect significant sinks and
sources of human flow according to the scalar potential in the case of
the Tokyo metropolitan area.</p>
<div class="section level3">
<h3 id="dataset-origin-destination-matrix-in-tokyo-with-trip-distance">Dataset: origin-destination matrix in Tokyo with trip distance<a class="anchor" aria-label="anchor" href="#dataset-origin-destination-matrix-in-tokyo-with-trip-distance"></a>
</h3>
<p>We used a dataset from the person-trip surveys conducted in 2018 in
the Tokyo metropolitan area, which is publicly available from <a href="https://www.tokyo-pt.jp/data/01_01" class="external-link">the Tokyo Metropolitan Region
Transportation Planning Commission</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">od</span> <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"tokyo2018.csv"</span>,</span>
<span>              col_types<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>trips <span class="op">=</span> <span class="st">"n"</span>, road_distance_in_km<span class="op">=</span><span class="st">"n"</span>,.default<span class="op">=</span><span class="st">"c"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">od</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 377,610 × 4</span></span></span>
<span><span class="co">#&gt;    origin dest  trips road_distance_in_km</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 0011   0010    990                3.24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 0012   0010   <span style="text-decoration: underline;">2</span>445                2.00</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 0020   0010   <span style="text-decoration: underline;">2</span>793                2.81</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 0021   0010      0                2.07</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 0022   0010      0                2.26</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 0023   0010   <span style="text-decoration: underline;">1</span>692                3.30</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 0024   0010   <span style="text-decoration: underline;">1</span>318                4.25</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 0030   0010   <span style="text-decoration: underline;">2</span>525                4.65</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 0031   0010    893                3.64</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 0032   0010   <span style="text-decoration: underline;">1</span>426                8.81</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 377,600 more rows</span></span></span></code></pre></div>
<p>The first two columns indicate the origin and destination zones,
representing the geographical zone code defined by the Tokyo
Metropolitan Region Transportation Planning Commission. The
<em>trips</em> column shows the number of trips. We added the
<em>road_distance_in_km</em> column showing the trip distance from the
origin to the destination. This distance is evaluated by the road
distance between the centroids of the origin and destination zones,
calculated by the <a href="https://project-osrm.org/" class="external-link">Open Source
Routing Machine (OSRM)</a> based on <a href="https://www.openstreetmap.org/" class="external-link">Open Street Map</a>. The dataset
contains 615 unique zones and 615 <span class="math inline">\(\times\)</span> 614 rows (excluding the trips
within each zone).</p>
</div>
<div class="section level3">
<h3 id="preprocess-convert-the-given-dataset-to-net-flow-y-on-a-graph-gve">Preprocess: convert the given dataset to net-flow <span class="math inline">\(Y\)</span> on a graph <span class="math inline">\(G(V,E)\)</span><a class="anchor" aria-label="anchor" href="#preprocess-convert-the-given-dataset-to-net-flow-y-on-a-graph-gve"></a>
</h3>
<p>As described in the main text, we denoted the net movements of people
as <span class="math inline">\(Y\)</span> on a graph $G(V,E). In the
current context, the vertices <span class="math inline">\(V\)</span>
correspond to the locations and the edges <span class="math inline">\(E\)</span> are the connections between them.</p>
<p>Distances <span class="math inline">\(d_{ij}\)</span> between
locations <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> crucially affect their connections.
Trips will be rare for long distances even if the potentials at the
endpoints differ. On the other hand, no trips are often observed for
short distances. This implies that zero movements happen in two distinct
situations. To distinguish the nonexistence of movements based on
distance and other factors, we assumed that a pair of locations is
connected if its road distance <span class="math inline">\(d_{ij}\)</span> is within a threshold <span class="math inline">\(\theta\)</span>.</p>
<p>We calculate the threshold distance <span class="math inline">\(\theta\)</span> above which trips are rarely
observed. We show the cumulative distribution of trip distance <span class="math inline">\(P(X&lt;d)\)</span> as a function of trip distance
<span class="math inline">\(d\)</span>. The threshold <span class="math inline">\(\theta\)</span> is determined based on criterion
<span class="math inline">\(P(X&lt;\theta) = 0.99\)</span>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">=</span> <span class="va">od</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">road_distance_in_km</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cum_trips <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">trips</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">=</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span> cum_dist <span class="op">=</span> <span class="va">cum_trips</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">trips</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 377,610 × 6</span></span></span>
<span><span class="co">#&gt;    origin dest  trips road_distance_in_km cum_trips  cum_dist</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1021   1020    208                1.00       208 0.000<span style="text-decoration: underline;">013</span>3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1020   1021   <span style="text-decoration: underline;">1</span>643                1.00      <span style="text-decoration: underline;">1</span>851 0.000<span style="text-decoration: underline;">118</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1022   1021    640                1.04      <span style="text-decoration: underline;">2</span>491 0.000<span style="text-decoration: underline;">159</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1021   1022    904                1.04      <span style="text-decoration: underline;">3</span>395 0.000<span style="text-decoration: underline;">216</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 3017   3013   <span style="text-decoration: underline;">1</span>383                1.17      <span style="text-decoration: underline;">4</span>778 0.000<span style="text-decoration: underline;">305</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 3013   3017    829                1.17      <span style="text-decoration: underline;">5</span>607 0.000<span style="text-decoration: underline;">358</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 6023   6021   <span style="text-decoration: underline;">1</span>820                1.17      <span style="text-decoration: underline;">7</span>427 0.000<span style="text-decoration: underline;">474</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 6021   6023   <span style="text-decoration: underline;">1</span>035                1.17      <span style="text-decoration: underline;">8</span>462 0.000<span style="text-decoration: underline;">540</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 6061   6060   <span style="text-decoration: underline;">2</span>601                1.18     <span style="text-decoration: underline;">11</span>063 0.000<span style="text-decoration: underline;">705</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 6060   6061    216                1.18     <span style="text-decoration: underline;">11</span>279 0.000<span style="text-decoration: underline;">719</span> </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 377,600 more rows</span></span></span>
<span></span>
<span><span class="co"># find intersection with threshold</span></span>
<span><span class="va">y0</span> <span class="op">=</span> <span class="fl">0.99</span></span>
<span><span class="va">RootLinearInterpolant</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">y0</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/is.unsorted.html" class="external-link">is.unsorted</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span>; <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">z</span> <span class="op">&lt;-</span> <span class="va">y</span> <span class="op">-</span> <span class="va">y0</span></span>
<span>  <span class="va">k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">z</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">z</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="va">xk</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">-</span> <span class="va">z</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">*</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">k</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">x</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">z</span><span class="op">[</span><span class="va">k</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">z</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">xk</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">thres</span> <span class="op">=</span> <span class="fu">RootLinearInterpolant</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">road_distance_in_km</span>, <span class="va">df</span><span class="op">$</span><span class="va">cum_dist</span>, <span class="va">y0</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">road_distance_in_km</span>, y<span class="op">=</span><span class="va">cum_dist</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth<span class="op">=</span><span class="fl">1.3</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Distance [km]"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Cumulative distribution, Prob. (X &lt; d)"</span><span class="op">)</span>  <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept<span class="op">=</span> <span class="va">y0</span>, color<span class="op">=</span><span class="st">"red"</span>, linetype<span class="op">=</span><span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x<span class="op">=</span><span class="va">thres</span>,xend<span class="op">=</span><span class="va">thres</span>, y<span class="op">=</span><span class="va">y0</span> <span class="op">-</span> <span class="fl">0.1</span>, yend<span class="op">=</span><span class="va">y0</span>, </span>
<span>           arrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/arrow.html" class="external-link">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"mm"</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="va">thres</span>, y <span class="op">=</span> <span class="va">y0</span> <span class="op">-</span> <span class="fl">0.15</span>, </span>
<span>           label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.1fkm"</span>, <span class="va">thres</span><span class="op">)</span>,size<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="PotentialInTokyo_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>Next, we make net flows between all pairs of locations and select
them by <span class="math inline">\(d_{ij} &lt; \theta\)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">od_forward</span> <span class="op">=</span> <span class="va">od</span> </span>
<span><span class="va">od_backward</span> <span class="op">=</span> <span class="va">od_forward</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">origin</span>,<span class="va">dest</span>,<span class="va">trips</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>origin_new <span class="op">=</span> <span class="va">dest</span>, dest_new <span class="op">=</span> <span class="va">origin</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>origin <span class="op">=</span> <span class="va">origin_new</span>, dest <span class="op">=</span> <span class="va">dest_new</span>, back_trips <span class="op">=</span> <span class="va">trips</span> <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">origin</span>, <span class="va">dest</span>, <span class="va">back_trips</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">netflow</span> <span class="op">=</span> <span class="va">od_forward</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">od_backward</span>,by <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/join_by.html" class="external-link">join_by</a></span><span class="op">(</span><span class="va">origin</span>, <span class="va">dest</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">origin</span> <span class="op">&gt;</span> <span class="va">dest</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>netflow <span class="op">=</span> <span class="va">trips</span> <span class="op">-</span> <span class="va">back_trips</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>vertex1 <span class="op">=</span> <span class="va">origin</span>, vertex2<span class="op">=</span><span class="va">dest</span><span class="op">)</span></span>
<span></span>
<span><span class="va">netflow_selected</span> <span class="op">=</span> <span class="va">netflow</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">road_distance_in_km</span> <span class="op">&lt;</span> <span class="va">thres</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">vertex1</span>,<span class="va">vertex2</span>,<span class="va">netflow</span><span class="op">)</span></span>
<span></span>
<span><span class="va">netflow_selected</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 117,329 × 3</span></span></span>
<span><span class="co">#&gt;    vertex1 vertex2 netflow</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 0011    0010        990</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 0012    0010       <span style="text-decoration: underline;">2</span>323</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 0020    0010       <span style="text-decoration: underline;">2</span>793</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 0021    0010          0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 0022    0010          0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 0023    0010       <span style="text-decoration: underline;">1</span>692</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 0024    0010       <span style="text-decoration: underline;">1</span>318</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 0030    0010       <span style="text-decoration: underline;">2</span>525</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 0031    0010        893</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 0032    0010       <span style="text-decoration: underline;">1</span>426</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 117,319 more rows</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="calculate-the-potential-s-for-the-net-flow-y">Calculate the potential <span class="math inline">\(s\)</span> for
the net flow <span class="math inline">\(Y\)</span><a class="anchor" aria-label="anchor" href="#calculate-the-potential-s-for-the-net-flow-y"></a>
</h3>
<p>The potential in Equation (1) in the main text is calculated by using
function <em>scalar_potential_on_graph</em> in the
<em>HodgePotentialHumanFlow</em> package.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">HodgePotentialHumanFlow</span><span class="op">)</span></span>
<span><span class="va">s</span> <span class="op">=</span> <span class="fu">HodgePotentialHumanFlow</span><span class="fu">::</span><span class="fu"><a href="../reference/scalar_potential_on_graph.html">scalar_potential_on_graph</a></span><span class="op">(</span><span class="va">netflow_selected</span><span class="op">)</span></span>
<span><span class="co">#&gt; Calculating p-values by monte calro (100000 steps).</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span>
<span><span class="co">#&gt;   zone potential pvalue_above</span></span>
<span><span class="co">#&gt; 1 0011  406.7119            0</span></span>
<span><span class="co">#&gt; 2 0012  494.1058            0</span></span>
<span><span class="co">#&gt; 3 0020  261.1093            0</span></span>
<span><span class="co">#&gt; 4 0021  222.9379            0</span></span>
<span><span class="co">#&gt; 5 0022  191.7659            0</span></span>
<span><span class="co">#&gt; 6 0023  227.1667            0</span></span></code></pre></div>
<p>The function returns a dataframe with three columns: zone, potential,
and <span class="math inline">\(p\)</span>-value. The <span class="math inline">\(p\)</span>-value indicates <span class="math inline">\(P(\hat{s}_i &gt; s_i)\)</span> under the null
hypothesis (see the main text for details). The sample number for
calculating this pseudo <span class="math inline">\(p\)</span>-value can
be specified by option <em>num_samples</em> (default = 1e5).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s</span> <span class="op">=</span> <span class="fu">HodgePotentialHumanFlow</span><span class="fu">::</span><span class="fu"><a href="../reference/scalar_potential_on_graph.html">scalar_potential_on_graph</a></span><span class="op">(</span><span class="va">netflow_selected</span>, num_samples <span class="op">=</span> <span class="fl">1e5</span><span class="op">)</span></span>
<span><span class="co">#&gt; Calculating p-values by monte calro (100000 steps).</span></span></code></pre></div>
<p>We plot the potential on a map using a shapefile publicly available
from <a href="https://www.tokyo-pt.jp/data/01_01" class="external-link">the Tokyo Metropolitan
Region Transportation Planning Commission</a>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Linking to GEOS 3.11.1, GDAL 3.6.3, PROJ 9.2.0; sf_use_s2() is TRUE</span></span>
<span><span class="va">map</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="st">"tokyo2018.gpkg"</span>, quiet<span class="op">=</span><span class="cn">T</span><span class="op">)</span> </span>
<span><span class="va">map</span> <span class="op">=</span> <span class="va">map</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(zone)`</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sjmgarnier.github.io/viridis/" class="external-link">viridis</a></span>,quietly <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/UrbanInstitute/urbnthemes" class="external-link">urbnthemes</a></span>,quietly<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://paleolimbot.github.io/ggspatial/" class="external-link">ggspatial</a></span>,quietly<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org" class="external-link">scales</a></span>,quiet <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">map</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">potential</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"black"</span>, lwd<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span>option<span class="op">=</span><span class="st">"viridis"</span>, trans<span class="op">=</span><span class="fu"><a href="https://scales.r-lib.org/reference/boxcox_trans.html" class="external-link">modulus_trans</a></span><span class="op">(</span><span class="fl">0.3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/urbnthemes/man/theme_urbn_map.html" class="external-link">theme_urbn_map</a></span><span class="op">(</span>base_family<span class="op">=</span><span class="st">"Helvetica"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.key.height<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1.5</span>,<span class="st">"line"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/annotation_scale.html" class="external-link">annotation_scale</a></span><span class="op">(</span>location <span class="op">=</span> <span class="st">"bl"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/annotation_north_arrow.html" class="external-link">annotation_north_arrow</a></span><span class="op">(</span>location <span class="op">=</span> <span class="st">"br"</span>, which_north <span class="op">=</span> <span class="st">"grid"</span>, </span>
<span>  style <span class="op">=</span> <span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/north_arrow_orienteering.html" class="external-link">north_arrow_fancy_orienteering</a></span><span class="op">(</span>text_size <span class="op">=</span><span class="fl">0</span>, line_width<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p><img src="PotentialInTokyo_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="detect-significant-sinks-and-sources">Detect significant sinks and sources<a class="anchor" aria-label="anchor" href="#detect-significant-sinks-and-sources"></a>
</h3>
<p>To detect significant sinks for zones with a positive potential, a
multiple-comparison test is performed using the <span class="math inline">\(p\)</span>-value under the control of the false
discovery rate (FDR), <span class="math inline">\(\alpha
(=0.05)\)</span>, with a standard Benjamini-Hochberg procedure.
Similarly, for zones with a negative potential, a multiple-comparison
test is performed using the <span class="math inline">\(p\)</span>-value
of <span class="math inline">\(1 - P(\hat{s}_i &gt; s_i)\)</span> under
FDR control.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_sink</span><span class="op">=</span> <span class="va">s</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">potential</span> <span class="op">&gt;=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">df_sink</span><span class="op">$</span><span class="va">pvalue_adj</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></span><span class="op">(</span><span class="va">df_sink</span><span class="op">$</span><span class="va">pvalue_above</span>, method<span class="op">=</span><span class="st">"fdr"</span><span class="op">)</span></span>
<span><span class="va">df_source</span><span class="op">=</span> <span class="va">s</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">potential</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">df_source</span><span class="op">$</span><span class="va">pvalue_adj</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">df_source</span><span class="op">$</span><span class="va">pvalue_above</span>, method<span class="op">=</span><span class="st">"fdr"</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">df_sink</span>, <span class="va">df_source</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="va">alpha</span> <span class="op">=</span> <span class="fl">0.05</span></span>
<span><span class="va">map</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="st">"tokyo2018.gpkg"</span>, quiet<span class="op">=</span><span class="cn">T</span><span class="op">)</span> </span>
<span><span class="va">map</span> <span class="op">=</span> <span class="va">map</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rowwise.html" class="external-link">rowwise</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>                      <span class="va">potential</span> <span class="op">&gt;=</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">pvalue_adj</span> <span class="op">&lt;</span> <span class="va">alpha</span> <span class="op">~</span> <span class="st">"Significant sink"</span>,</span>
<span>                      <span class="va">potential</span> <span class="op">&lt;</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">pvalue_adj</span> <span class="op">&lt;</span> <span class="va">alpha</span> <span class="op">~</span> <span class="st">"Significant source"</span>,</span>
<span>   <span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(zone)`</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">map</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"black"</span>, lwd<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/urbnthemes/man/theme_urbn_map.html" class="external-link">theme_urbn_map</a></span><span class="op">(</span>base_family<span class="op">=</span><span class="st">"Helvetica"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#e41a1c"</span>,<span class="st">"navyblue"</span><span class="op">)</span>,na.translate <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.title<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="PotentialInTokyo_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Takaaki Aoki.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
